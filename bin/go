#!/usr/bin/env bash

set -euo pipefail
DIR="$( cd -- "$( dirname -- "${BASH_SOURCE[0]}" )" &> /dev/null && pwd)"
cd "$DIR/../home"

_help() (
  cat <<EOF
Usage: $(basename ${0}) cmd

where cmd is one of:

help     Displays this help text.
sync     Replaces files in this repos with links to \$HOME.
EOF
)

_sync() (
  for f in $(cd dot; find . -type f); do
    h=$HOME/.${f:2}
    touch $h
    rm dot/${f:2}
    ln $h dot/${f:2}
  done
)

_main() (
  case "${1:-}" in
    help|sync)
      _$1
      ;;
    *)
      _help
      exit 1
      ;;
  esac
)

_main $@
